{"ast":null,"code":"var _jsxFileName = \"/Users/chuan/Documents/web3/l5web/dapp-frontend/src/page.js\",\n  _s = $RefreshSig$();\nimport React from \"react\";\nimport { useEffect, useState } from \"react\";\nimport { TinTinTokenContract, connectWallet, transferToken, loadTokenName, loadTokenAccountBalance, getCurrentWalletConnected } from \"./util/web3interact.js\";\nimport TinTinlogo from \"./assets/tintinLogo.jpeg\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TinTinToken = () => {\n  _s();\n  const [walletAddress, setWallet] = useState(\"\"); // 连接钱包的地址\n  const [status, setStatus] = useState(\"\"); // 状态信息，告诉user 现在的交互状态，\n  const [tokenName, setTokenName] = useState(\"No connection.\"); // Token名称\n  const [tokenBalance, settokenBalance] = useState(\"No connection.\"); // 智能合约交互时，获取的信息。\n  const [toAddress, setToAddress] = useState(\"\"); // 发送token 接收方的地址\n  const [totalSupply, setTotalSupply] = useState(0);\n\n  // 当walletAddress值变化时，就会执行。 \n  useEffect(() => {\n    async function fetchData() {\n      if (walletAddress !== \"\") {\n        const tokenBalance = await loadTokenAccountBalance(walletAddress);\n        settokenBalance(tokenBalance);\n      }\n      const tokenName = await loadTokenName();\n      setTokenName(tokenName);\n      const {\n        address,\n        status\n      } = await getCurrentWalletConnected();\n      setWallet(address);\n      setStatus(status);\n      addWalletListener();\n      addSmartContractListener();\n    }\n    fetchData();\n  }, [walletAddress]);\n\n  // 监听metamask 连接账户的改变，然后实时显示在前端。\n  function addWalletListener() {\n    if (window.ethereum) {\n      window.ethereum.on(\"accountsChanged\", accounts => {\n        if (accounts.length > 0) {\n          setWallet(accounts[0]);\n          setStatus(\"👆🏽 input the transfer to addresst in the text-field above.\");\n        } else {\n          setWallet(\"\");\n          setStatus(\"🦊 Connect to Metamask using the top right button.\");\n        }\n      });\n    } else {\n      setStatus( /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\" \", \"\\uD83E\\uDD8A\", \" \", /*#__PURE__*/_jsxDEV(\"a\", {\n          target: \"_blank\",\n          href: `https://metamask.io/download.html`,\n          children: \"You must install Metamask, a virtual Ethereum wallet, in your browser.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 5\n      }, this));\n    }\n  }\n\n  // 监听 智能合约\n  function addSmartContractListener() {\n    TinTinTokenContract.events.Transfer({}, (error, data) => {\n      console.log(data);\n      if (error) {\n        setStatus(\"😥 \" + error.message);\n      } else {\n        setToAddress(\"\");\n        setStatus(\"token transfer completed\");\n      }\n    });\n  }\n\n  // 连接钱包按钮被点击时候，执行连接钱包，并更新状态。\n  const connectWalletPressed = async () => {\n    const walletResponse = await connectWallet();\n    setStatus(walletResponse.status);\n    setWallet(walletResponse.address);\n  };\n\n  // 发送token，并更新状态。\n  const onTransferPressed = async () => {\n    const {\n      status\n    } = await transferToken(walletAddress, toAddress);\n    setStatus(status);\n  };\n\n  //the UI of our component\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"img\", {\n      id: \"logo\",\n      src: TinTinlogo\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      id: \"walletButton\",\n      onClick: connectWalletPressed,\n      children: walletAddress.length > 0 ? \"Connected: \" + String(walletAddress).substring(0, 6) + \"...\" + String(walletAddress).substring(38) : /*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"Connect Wallet\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 6\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      style: {\n        paddingTop: \"50px\"\n      },\n      children: \"Token Name:\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: tokenName\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      style: {\n        paddingTop: \"50px\"\n      },\n      children: \"Balance:\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: tokenBalance\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      style: {\n        paddingTop: \"50px\"\n      },\n      children: \"Total Supply:\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: tokenBalance\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      style: {\n        paddingTop: \"18px\"\n      },\n      children: \"Transfer 1 TinTin Token To:\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"transfer token to:\",\n        onChange: e => setToAddress(e.target.value),\n        value: toAddress\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        id: \"status\",\n        children: status\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        id: \"publish\",\n        onClick: onTransferPressed,\n        children: \"Transfer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 3\n  }, this);\n};\n_s(TinTinToken, \"tI59SDzII2X7A/ti/qskruHFNPg=\");\n_c = TinTinToken;\nexport default TinTinToken;\nvar _c;\n$RefreshReg$(_c, \"TinTinToken\");","map":{"version":3,"names":["React","useEffect","useState","TinTinTokenContract","connectWallet","transferToken","loadTokenName","loadTokenAccountBalance","getCurrentWalletConnected","TinTinlogo","TinTinToken","walletAddress","setWallet","status","setStatus","tokenName","setTokenName","tokenBalance","settokenBalance","toAddress","setToAddress","totalSupply","setTotalSupply","fetchData","address","addWalletListener","addSmartContractListener","window","ethereum","on","accounts","length","events","Transfer","error","data","console","log","message","connectWalletPressed","walletResponse","onTransferPressed","String","substring","paddingTop","e","target","value"],"sources":["/Users/chuan/Documents/web3/l5web/dapp-frontend/src/page.js"],"sourcesContent":["import React from \"react\";\nimport { useEffect, useState } from \"react\";\nimport {\n\tTinTinTokenContract,\n\tconnectWallet,\n\ttransferToken,\n\tloadTokenName,\n\tloadTokenAccountBalance,\n\tgetCurrentWalletConnected,\n} from \"./util/web3interact.js\";\n\nimport TinTinlogo from \"./assets/tintinLogo.jpeg\";\n\nconst TinTinToken = () => {\n\tconst [walletAddress, setWallet] = useState(\"\");                     // 连接钱包的地址\n\tconst [status, setStatus] = useState(\"\");                            // 状态信息，告诉user 现在的交互状态，\n\tconst [tokenName, setTokenName] = useState(\"No connection.\");        // Token名称\n\tconst [tokenBalance, settokenBalance] = useState(\"No connection.\");  // 智能合约交互时，获取的信息。\n\tconst [toAddress, setToAddress] = useState(\"\");                      // 发送token 接收方的地址\n\tconst [totalSupply, setTotalSupply] = useState(0);\n\n\t// 当walletAddress值变化时，就会执行。 \n\tuseEffect(() => {\n\t\tasync function fetchData() {\n\t\t\tif (walletAddress !== \"\") {\n\t\t\t\tconst tokenBalance = await loadTokenAccountBalance(walletAddress);\n\t\t\t\tsettokenBalance(tokenBalance);\n\t\t\t}\n\t\t\tconst tokenName = await loadTokenName();\n\t\t\tsetTokenName(tokenName);\n\t\t\tconst { address, status } = await getCurrentWalletConnected();\n\t\t\tsetWallet(address);\n\t\t\tsetStatus(status);\n\t\t\taddWalletListener();\n\t\t\taddSmartContractListener();\n\t\t}\n\t\tfetchData();\n\t}, [walletAddress]);\n\n  // 监听metamask 连接账户的改变，然后实时显示在前端。\n\tfunction addWalletListener() {\n\t\tif (window.ethereum) {\n\t\t\twindow.ethereum.on(\"accountsChanged\", (accounts) => {\n\t\t\t\tif (accounts.length > 0) {\n\t\t\t\t\tsetWallet(accounts[0]);\n\t\t\t\t\tsetStatus(\n\t\t\t\t\t\t\"👆🏽 input the transfer to addresst in the text-field above.\"\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tsetWallet(\"\");\n\t\t\t\t\tsetStatus(\"🦊 Connect to Metamask using the top right button.\");\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tsetStatus(\n\t\t\t\t<p>\n\t\t\t\t\t{\" \"}\n\t\t\t\t\t🦊{\" \"}\n\t\t\t\t\t<a target=\"_blank\" href={`https://metamask.io/download.html`}>\n\t\t\t\t\t\tYou must install Metamask, a virtual Ethereum wallet, in your\n\t\t\t\t\t\tbrowser.\n\t\t\t\t\t</a>\n\t\t\t\t</p>\n\t\t\t);\n\t\t}\n\t}\n\n  // 监听 智能合约\n\tfunction addSmartContractListener() {\n\t\tTinTinTokenContract.events.Transfer({}, (error, data) => {\n\t\t\tconsole.log(data);\n\t\t\tif (error) {\n\t\t\t\tsetStatus(\"😥 \" + error.message);\n\t\t\t} else {\n\t\t\t\tsetToAddress(\"\");\n\t\t\t\tsetStatus(\"token transfer completed\");\n\t\t\t}\n\t\t});\n\t}\n\n  // 连接钱包按钮被点击时候，执行连接钱包，并更新状态。\n\tconst connectWalletPressed = async () => {\n\t\tconst walletResponse = await connectWallet();\n\t\tsetStatus(walletResponse.status);\n\t\tsetWallet(walletResponse.address);\n\t};\n\n  // 发送token，并更新状态。\n\tconst onTransferPressed = async () => {\n\t\tconst { status } = await transferToken(walletAddress, toAddress);\n\t\tsetStatus(status);\n\t};\n\n\t//the UI of our component\n\treturn (\n\t\t<div id=\"container\">\n\t\t\t<img id=\"logo\" src={TinTinlogo}></img>\n\t\t\t<button id=\"walletButton\" onClick={connectWalletPressed}>\n\t\t\t\t{walletAddress.length > 0 ? (\n\t\t\t\t\t\"Connected: \" +\n\t\t\t\t\tString(walletAddress).substring(0, 6) +\n\t\t\t\t\t\"...\" +\n\t\t\t\t\tString(walletAddress).substring(38)\n\t\t\t\t) : (\n\t\t\t\t\t<span>Connect Wallet</span>\n\t\t\t\t)}\n\t\t\t</button>\n\n\t\t\t<h2 style={{ paddingTop: \"50px\" }}>Token Name:</h2>\n\t\t\t<p>{tokenName}</p>\n\n\t\t\t<h2 style={{ paddingTop: \"50px\" }}>Balance:</h2>\n\t\t\t<p>{tokenBalance}</p>\n\n\t\t\t<h2 style={{ paddingTop: \"50px\" }}>Total Supply:</h2>\n\t\t\t<p>{tokenBalance}</p>\n\n\t\t\t<h2 style={{ paddingTop: \"18px\" }}>Transfer 1 TinTin Token To:</h2>\n\n\t\t\t<div>\n\t\t\t\t<input\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tplaceholder=\"transfer token to:\"\n\t\t\t\t\tonChange={(e) => setToAddress(e.target.value)}\n\t\t\t\t\tvalue={toAddress}\n\t\t\t\t/>\n\t\t\t\t<p id=\"status\">{status}</p>\n\n\t\t\t\t<button id=\"publish\" onClick={onTransferPressed}>\n\t\t\t\t\tTransfer\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default TinTinToken;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}